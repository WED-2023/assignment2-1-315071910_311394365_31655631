"use strict";(self["webpackChunkassignment_2_1"]=self["webpackChunkassignment_2_1"]||[]).push([[362],{2362:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var a=function(){var e=this,t=e._self._c;return t("div",[t("br"),t("h1",{staticClass:"title"},[e._v("Meal Planning")]),t("div",{staticClass:"meal-planning-container"},[e.isLoading?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"loading-spinner"}),t("div",{staticClass:"loading-text"},[e._v("Loading...")])]):t("div",[e.mealRecipes.length?t("div",{staticClass:"meal-recipes"},[e._l(e.mealRecipes,(function(r,a){return t("div",{key:r.id,staticClass:"meal-recipe",class:{dragging:e.draggingIndex===a},attrs:{draggable:"true"},on:{dragstart:function(t){return e.onDragStart(a,t)},dragover:function(t){return e.onDragOver(t)},drop:function(t){return e.onDrop(a)},dragend:e.onDragEnd}},[t("div",{staticClass:"meal-recipe-content"},[t("div",{staticClass:"meal-recipe-image-container"},[t("img",{staticClass:"meal-recipe-photo",attrs:{src:r.image,alt:"Recipe Photo"}})]),t("div",{staticClass:"meal-recipe-details"},[t("div",{staticClass:"meal-recipe-header"},[t("span",{staticClass:"meal-recipe-number"},[e._v(e._s(a+1)+". "+e._s(r.title))]),t("button",{staticClass:"remove-btn",on:{click:function(t){return e.removeRecipeFromMeal(r.id)}}},[e._v("Ã—")])]),t("span",{staticClass:"meal-recipe-time"},[t("i",{staticClass:"fas fa-clock"}),e._v(" "+e._s(r.readyInMinutes)+" Minutes")]),t("div",{staticClass:"meal-recipe-status",class:e.getStatusClass(r.status)},[t("span",[e._v(e._s(r.status))]),t("i",{class:e.getStatusIcon(r.status)})]),t("div",{staticClass:"progress-bar-container"},[t("progress-bar",{attrs:{progress:Math.floor(100*r.progress)}})],1),t("router-link",{staticClass:"start-preparation",attrs:{to:{name:"RecipePreparation",params:{recipeId:r.id}}},nativeOn:{click:function(t){return e.startPreparation(r)}}},[t("i",{staticClass:"fas fa-play-circle"}),e._v(" Start Preparation ")])],1)])])})),t("button",{staticClass:"clear-meal-btn",on:{click:e.showClearMealModal}},[e._v("Clear All Recipes From Meal Plan")])],2):t("div",{staticClass:"no-recipes"},[e._v("No recipes added to the meal plan yet.")])])]),t("b-modal",{attrs:{id:"clear-meal-modal"},on:{ok:e.clearMeal},scopedSlots:e._u([{key:"modal-title",fn:function(){return[e._v("Clear Meal Plan")]},proxy:!0}])},[e._v(" Are you sure you want to clear all recipes from the meal plan? ")])],1)},s=[],n=r(3144),i=r(124),c=r(8534),o=(r(1249),r(2707),r(2772),r(2222),r(7327),r(1539),r(8862),r(561),r(9669)),l=r.n(o),u=function(){var e=this,t=e._self._c;return t("div",{staticClass:"progress-bar"},[t("div",{class:["progress-bar-fill",e.progressColor],style:{width:e.progress+"%"}}),t("span",{staticClass:"progress-bar-text"},[e._v(e._s(e.progress)+"%")])])},p=[];r(9653);const d={props:{progress:{type:Number,required:!0}},computed:{progressColor:function(){return this.progress>=75?"progress-bar-high":this.progress>=50?"progress-bar-medium":"progress-bar-low"}}},g=d;var m=r(1001),f=(0,m.Z)(g,u,p,!1,null,"3c009240",null);const v=f.exports,h={name:"MealPlanning",components:{ProgressBar:v},data:function(){return{mealRecipes:[],draggingIndex:null,isLoading:!0}},mounted:function(){var e=this;return(0,c.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRecipes();case 2:case"end":return t.stop()}}),t)})))()},methods:{getRecipes:function(){var e=this;return(0,c.Z)((0,i.Z)().mark((function t(){var r,a;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l().get("".concat(e.$root.store.server_domain,"/users/meal_plan"),{withCredentials:!0,headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}});case 3:r=t.sent,e.mealRecipes=r.data.map((function(t){return(0,n.Z)((0,n.Z)({},t),{},{time:t.time||0,status:e.getRecipeStatusText(t.status),progress:t.progress||0})})),a=JSON.parse(localStorage.getItem("mealRecipesOrder")),a&&(e.mealRecipes=e.mealRecipes.sort((function(e,t){return a.indexOf(e.id)-a.indexOf(t.id)}))),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.error("Error fetching meal recipes:",t.t0);case 12:return t.prev=12,e.isLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[0,9,12,15]])})))()},startPreparation:function(e){var t=this;return(0,c.Z)((0,i.Z)().mark((function r(){return(0,i.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(l().defaults.withCredentials=!0,"Wait For Processing"!==e.status){r.next=14;break}return r.prev=2,r.next=5,l().post("".concat(t.$root.store.server_domain,"/users/meal_plan/").concat(e.id,"/1"),{},{withCredentials:!0});case 5:e.status=t.getRecipeStatusText("1"),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](2),console.error("Error updating recipe status:",r.t0);case 11:return r.prev=11,l().defaults.withCredentials=!1,r.finish(11);case 14:case"end":return r.stop()}}),r,null,[[2,8,11,14]])})))()},removeRecipeFromMeal:function(e){var t=this;return(0,c.Z)((0,i.Z)().mark((function r(){var a;return(0,i.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.mealRecipes=t.mealRecipes.filter((function(t){return t.id!==e})),r.prev=1,r.next=4,l()["delete"]("".concat(t.$root.store.server_domain,"/users/meal_plan"),{data:{recipeId:String(e)},withCredentials:!0});case 4:t.$root.$emit("update-meal-count"),r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](1),console.error("Error removing recipe from meal plan:",r.t0);case 10:a=t.mealRecipes.map((function(e){return e.id})),localStorage.setItem("mealRecipesOrder",JSON.stringify(a));case 12:case"end":return r.stop()}}),r,null,[[1,7]])})))()},clearMeal:function(){var e=this;return(0,c.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l()["delete"]("".concat(e.$root.store.server_domain,"/users/meal_plan/all"),{withCredentials:!0});case 3:e.mealRecipes=[],localStorage.removeItem("mealRecipesOrder"),e.$root.$emit("update-meal-count"),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.error("Error clearing meal plan:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},showClearMealModal:function(){this.$bvModal.show("clear-meal-modal")},onDragStart:function(e,t){this.draggingIndex=e,t.dataTransfer.effectAllowed="move"},onDragOver:function(e){e.preventDefault()},onDrop:function(e){if(e!==this.draggingIndex){var t=this.mealRecipes[this.draggingIndex];this.mealRecipes.splice(this.draggingIndex,1),this.mealRecipes.splice(e,0,t),this.draggingIndex=null;var r=this.mealRecipes.map((function(e){return e.id}));localStorage.setItem("mealRecipesOrder",JSON.stringify(r))}},onDragEnd:function(){this.draggingIndex=null},getStatusClass:function(e){switch(e){case"Wait For Processing":return"status-wait";case"In Process":return"status-process";case"Complete!":return"status-ready";default:return""}},getStatusIcon:function(e){switch(e){case"Wait For Processing":return"fas fa-clock";case"In Process":return"fas fa-spinner";case"Complete!":return"fas fa-check-circle";default:return""}},getRecipeStatusText:function(e){switch(e){case"0":return"Wait For Processing";case"1":return"In Process";case"2":return"Complete!";default:return"Wait For Processing"}}}},C=h;var _=(0,m.Z)(C,a,s,!1,null,"101ae63e",null);const w=_.exports}}]);
//# sourceMappingURL=362.1a8d861b.js.map